# GeoGail

Synthesized human trajectories are crucial for a large number of applications. Existing solutions are mainly based on the generative adversarial network (GAN), which is limited due to the lack of modeling the human decision-making process. In this paper, we propose a novel imitation learning based method to synthesize human trajectories.  This model utilizes a novel semantics-based interaction mechanism between the decision-making strategy and visitations to diverse geographical locations to model them in the semantic domain in a uniform manner. To augment the modeling ability to the real-world human decision-making policy, we propose a feature extraction model to extract the internal latent factors of variation of different individuals, and then propose a novel self-attention based policy net to capture the long-term correlation of mobility and decision-making patterns. Then, to better reward users' mobility behavior, we propose a novel multi-scale reward net combined with mutual information to model the instant reward, long-term reward, and individual characteristics in a cohesive manner. Extensive experimental results on two real-world trajectory datasets show that our proposed model can synthesize the most high-quality trajectory data compared with six state-of-the-art baselines in terms of a number of key usability metrics, and can well support practical applications based on trajectory data, demonstrating its effectiveness. What's more, our proposed method can learn explainable knowledge automatically from data, including explainable statistical features of trajectories and statistical relation between decision-making policy and features.
![Result](Framework_Overall2.png)

## Table of Contents

- [Background](#background)
- [Install](#install)
- [Usage](#usage)
	- [Data](#data)
	- [Model](#model)
	- [Quantiazationmethod](#quantiazationmethod)
- [Contributors](#contributors)
- [License](#license)

## Background

Synthetic human trajectories are instrumental for a wide-range of applications, including network service optimization, transportation scheduling, etc.For example, in cellular networks, based on synthesized trajectories, we can simulate the detailed process of movement and communication of network users to have a reliable performance analysis of the network. Similarly, we can simulate the traffic congestion before and after the implementation of certain policies (e.g., road expansion) based on synthetic human trajectories, which are crucial for urban plannin

However, synthesizing human trajectories is also challenging due to the complicated spatio-temporal correlation, and large stochasticity of the mobility trajectories.
The rise of the deep learning paradigm provides promising solutions to synthesize high-quality human trajectories, where the most successful and prominent methods are based on the generative adversarial network (GAN).
Specifically,  GAN utilizes a generator to synthesize new data, and a discriminator to distinguish generated data and real data. Then, it is trained through a mutual game between the generator network and the discriminator network.
Utilizing the strong modeling ability of GAN, existing approaches combine it with CNNand RNN to synthesize human trajectories.
However, human trajectories are generated by the complicated human decision-making process, while GAN is designed to directly learn the data distribution from demonstrations without modeling the hidden decision-making process, leading to its weakness including the frequent mode collapse, lack of interpretability, and under-performance on unseen data.

## Install

This project uses pytorch and jyupter notebook. Go check them out if you don't have them locally installed.


## Usage

This is only a documentation package.


### Data

To get the data for the model.
#### Data for MLP
[train|dev]_labels.npy contain a numpy object array of shape [utterances]. Each element in the array is an int32 array of shape [time] and provides the phoneme state label for each frame. There are 71 distinct labels [0-70], one for each subphoneme.

```sh
$ kaggle competitions download -c 11785-spring2021-hw1p2
```
#### Data for CNNs
Given an image of a personâ€™s face, the task of classifying the ID of the face is known as face classification. The input to your system will be a face image and you will have to predict the ID of the face. The ground truth will be present in the training data and the network will be doing an
Multi-class Classification to get the prediction. You are provided with a validation set for fine-tuning your model.

```sh
$ kaggle competitions download -c 11785-spring2021-hw2p2s1-face-classification
```
### Model

Toy model of MLP and CNN
#### MLP structure 
![Result](baseline_model.png?raw=true)

```sh
$ run MLP.ipynb
```
#### CNN structure 
![Result](Resnet34.png?raw=true)

```sh
$ run CNN--resnet34.ipynb
```
### Quantiazationmethod

Kmeans method for quantization


### Contributors

This project exists thanks to all the people who contribute. 

## License

[MIT](LICENSE)
